<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Vehicle Tracker</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
</head>
<body>
    <div class="container">
        <!-- Header -->
        <div class="header">
            <h1>ðŸš— Vehicle Maintenance Tracker</h1>
            <p>Manage and track all your vehicles in one place</p>
        </div>

        <!-- Alert Messages -->
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }}">
                {{ message }}
              </div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <!-- Action Bar: Add Button and Search -->
        <div class="action-bar">
            <a href="/add_vehicle" class="btn btn-primary">+ Add New Vehicle</a>
            
            <!-- Search Form -->
            <form method="GET" action="/" class="search-container">
                <input 
                    type="text" 
                    name="search" 
                    class="search-input" 
                    placeholder="Search by brand, model, or plate number..."
                    value="{{ search_query }}"
                >
            </form>
        </div>

        <!-- Section Header -->
        <div class="section-header">
            <h2>Your Vehicles</h2>
            {% if vehicles %}
                <span style="color: #718096;">{{ vehicles|length }} vehicle(s)</span>
            {% endif %}
        </div>

        <!-- Vehicles Grid -->
        {% if vehicles %}
            <div class="vehicles-grid">
                {% for v in vehicles %}
                <div class="vehicle-card">
                    <div class="vehicle-icon">ðŸš™</div>
                    <div class="vehicle-brand">{{ v.brand }}</div>
                    <div class="vehicle-model">{{ v.model }}</div>
                    <div class="vehicle-details">
                        <span><strong>Year:</strong> {{ v.year }}</span>
                        <span><strong>Plate:</strong> {{ v.plate_number }}</span>
                        <span><strong>ID:</strong> #{{ v.id }}</span>
                    </div>
                    <div class="vehicle-actions">
                        <a href="{{ url_for('view_vehicle', vehicle_id=v.id) }}" class="btn btn-secondary btn-small">View</a>
                        <a href="{{ url_for('edit_vehicle', vehicle_id=v.id) }}" class="btn btn-primary btn-small">Edit</a>
                        <form method="POST" action="{{ url_for('delete_vehicle', vehicle_id=v.id) }}" style="display: inline;" onsubmit="return confirm('Are you sure you want to delete this vehicle?');">
                            <button type="submit" class="btn btn-danger btn-small">Delete</button>
                        </form>
                    </div>
                </div>
                {% endfor %}
            </div>
        {% else %}
            <div class="empty-state">
                <div class="empty-state-icon">ðŸš—</div>
                <h3>No vehicles found</h3>
                <p>{% if search_query %}Try a different search term{% else %}Get started by adding your first vehicle!{% endif %}</p>
                {% if not search_query %}
                    <a href="/add_vehicle" class="btn btn-primary mt-20">Add Your First Vehicle</a>
                {% endif %}
            </div>
        {% endif %}

        <!-- Statistics -->
        {% if total > 0 %}
        <div class="stats-container">
            <div class="stat-card">
                <div class="stat-value">{{ total }}</div>
                <div class="stat-label">Total Vehicles</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ oldest }}</div>
                <div class="stat-label">Oldest Vehicle</div>
            </div>
            <div class="stat-card">
                <div class="stat-value">{{ newest }}</div>
                <div class="stat-label">Newest Vehicle</div>
            </div>
        </div>
        {% endif %}
    </div>
</body>
</html>
